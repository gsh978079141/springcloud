## 配置加载顺序

## 配置文件名称
springboot应用 配置文件的默认名称为application。
想要自定义配置文件名称，可以在启动jar包时指定
````shell
java -jar project-sample.jar --spring.config.name=custome
````

### 不同配置目录的加载顺序
SpringBoot默认会从四个目录加载所有配置文件，并互补配置；  
以下为配置目录加载的顺序，后加载的配置优先级更高，会覆盖之前加载的配置。

| 加载顺序 | 配置存放目录 | 目录说明 |
| :---: | :--- | :--- |
| 1 | -classpath:/ | resources目录 |
| 2 | -classpath:/config/ | resources的 config目录 | 
| 3 | -file:./ | 项目根目录下 |
| 4 | -file:./config/ | 项目根目录config文件夹下 |

**为了保持简单，在项目开发中一般都是将配置文件放在同一个目录下，通常是src/main/resources**


### 同一目录下不同配置的加载顺序
spring支持properties，yaml，yml后缀的配置文件。

在使用当前默认配置名称application, spring.profiles.active为dev的情况下， 配置文件加载顺序：

application.yaml -> application-dev.yaml ->
application.yml -> application-dev.yml ->
application.properties > application-dev.properties

后加载的配置会覆盖之前的配置，所以以上配置都存在时，application-dev.properties优先级最高，因为它最后被加载，所以会覆盖之前的相同配置。

例如，以上所有配置文件如果都定义了server.port属性，那最终以application-dev.properties里定义的为准。 

**为了保持简单，同一个项目，应该使用相同后缀的配置文件，不要混用。**



### bootstrap配置与application配置
bootstrap配置是spring cloud 上下文的配置，单纯的springboot应用不会去读取bootstrap配置。
如果项目里依赖了 spring-cloud-starter包，那就拥有了spring cloud 的上下文。
例如，项目里依赖了spring-cloud-starter-openfeign，也就间接依赖了spring-cloud-starter，也就有了spring cloud 上下文。

启动上下文时，Spring Cloud 会创建一个 Bootstrap Context，作为 Spring 应用的 Application Context 的父上下文。

初始化的时候，Bootstrap Context 负责从外部源加载配置属性并解析配置。这两个上下文共享一个从外部获取的 Environment。Bootstrap 属性有高优先级，默认情况下，它们不会被本地配置覆盖。

bootstrap.yml（bootstrap.properties）在application.yml（application.properties）之前加载，就像application.yml一样，但是用于应用程序上下文的引导阶段。
它通常用于在使用外部配置中心时，应在bootstrap.yml中指定spring.application.name和外部配置中心的连接信息以及一些加密/解密信息。

技术上，bootstrap.yml由父Spring ApplicationContext加载。父ApplicationContext被加载到使用application.yml的之前。
bootstrap配置用来程序引导时执行，应用于更加早期配置信息读取。  

**bootstrap 属性有高优先级，默认情况下，它们不会被本地配置覆盖。**
这句话的意思并不是说所有在bootstrap.yml里定义的配置都不会被application.yml里的文件覆盖。
更准确的说是bootstrap配置关注的引导类配置不会被application配置覆盖

